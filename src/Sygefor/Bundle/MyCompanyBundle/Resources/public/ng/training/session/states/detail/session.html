<form sf-xeditable-form="form" sf-href='session.view({id: session.id})' on-success="onSuccess(data)">
    <div class="row session">

        <!--
         Infos
        -->
        <div class="col-md-8">
            <div class="btn-group pull-right">
                <a class="btn btn-fa" href="" tooltip="Publipostage" ng-click="$dialog.open('batch.publipost', { items: [session.id], service: 'session' })"><span class="fa fa-file-word-o"></span></a>
                <a class="btn btn-fa" href="" tooltip="Voir l'événement" ng-if="session.training._accessRights.view" ui-sref="training.detail.view({id: session.training.id})"><span class="fa fa-calendar"></span></a>
                <a class="btn btn-fa" href="" ng-if="!session.promote && session._accessRights.edit" tooltip="Promouvoir la session" ng-click="promote(1)"><span class="fa fa-star-o"></span></a>
                <a class="btn btn-fa" href="" ng-if="session.promote && session._accessRights.edit" tooltip="Dépromouvoir la session" ng-click="promote(0)"><span class="fa fa-star fa-highlight"></span></a>
                <a class="btn btn-fa" href="" tooltip="Dupliquer" ng-if="session._accessRights.edit" ng-click="duplicate()"><span class="fa fa-copy"></span></a>
                <a class="btn btn-fa" href="" tooltip="Supprimer" ng-if="session._accessRights.delete" ng-click="delete()"><span class="fa fa-trash-o"></span></a>
            </div>

            <div class="pre-title">{{ session.training.typeLabel }} n°{{ session.training.id }} -  {{ session.training.name }}</div>
            <h2>Session <span sf-xeditable="form.children.name" data-type="text">{{ session.name }}</span> du {{ session.dateBegin|date: 'dd MMMM y' }} <span ng-if="session.dateEnd"> au {{ session.dateEnd|date: 'dd MMMM y' }}</span></h2>

            <div class="infos" ng-if="form.children.module">
                <div><label>Module :</label> <span sf-xeditable="form.children.module" data-type="select">{{ session.module.name }}</span></div>
                <div><label>Type :</label> <span sf-xeditable="form.children.type" data-type="select">{{ session.type.name }}</span></div>
            </div>

            <h3>Informations</h3>
            <hr>
            <div class="row mb-1">
                <div class="col-lg-6">
                    <ul class="summary">
                        <li><label>Date</label> <span sf-xeditable="form.children.dateBegin">{{ session.dateBegin|date: 'dd/MM/yyyy' }}</span></li>
                        <li><label>Date de fin</label> <span sf-xeditable="form.children.dateEnd">{{ session.dateEnd|date: 'dd/MM/yyyy' }}</span></li>
                        <li><label>Horaires</label> <span sf-xeditable="form.children.schedule">{{ session.schedule }}</span></li>
                        <li><label>Nombre d'heures</label> <span sf-xeditable="form.children.hourNumber">{{ session.hourNumber }}</span></li>
                        <li><label>Nombre de jours</label> <span sf-xeditable="form.children.dayNumber">{{ session.dayNumber }}</span></li>
                        <li><label>Tarif</label> <span sf-xeditable="form.children.price">{{ session.price ? session.price : '0' }} €</span></li>
                    </ul>
                </div>
                <div class="col-lg-6">
                    <ul class="summary">
                        <li><label>Lieu</label> <span sf-xeditable="form.children.place" data-mode="popup" data-type="select">{{ session.place.name }}</span></li>
                        <li><label>Inscriptions</label> <span sf-xeditable="form.children.registration">{{ $trainingBundle.registrationStates[session.registration] }}</span></li>
                        <li><label>Afficher en ligne</label> <span sf-xeditable="form.children.displayOnline">{{ session.displayOnline ? 'Oui' : 'Non' }}</span></li>
                        <li><label>Statut</label> <span sf-xeditable="form.children.status">{{ $trainingBundle.statusStates[session.status] }}</span></li>
                        <li ng-if="!session.registration"><label>Nombre d'inscriptions</label> <span sf-xeditable="form.children.numberOfRegistrations">{{ session.numberOfRegistrations }}</span></li>
                        <li><label>Participants max</label> <span sf-xeditable="form.children.maximumNumberOfRegistrations">{{ session.maximumNumberOfRegistrations }}</span></li>
                        <li><label>Date limite</label> <span sf-xeditable="form.children.limitRegistrationDate">{{ session.limitRegistrationDate|date: 'dd/MM/yyyy' }}</span></li>
                    </ul>
                </div>
            </div>

            <ul class="nav nav-tabs">
                <li ng-click="tab = 'inscriptions'" class="active"><a href="" data-toggle="tab"><span class="fa fa-graduation-cap"></span> {{ session.registration > 0 ? 'Inscriptions (' + session.inscriptions.length + ')' : 'Participants (' + getTotal() + ')' }}</a></li>
                <li ng-click="tab = 'messages'"><a href="" data-toggle="tab"><span class="fa fa-send"></span> Messages ({{ session.messages.length ? session.messages.length : 0 }})</a></li>
            </ul>

            <!--
             Inscriptions
            -->
            <div ng-show="!tab || tab === 'inscriptions'">
                <div class="row">
                    <div class="col-lg-12">
                        <!-- opened inscriptions -->
                        <div ng-if="session.registration > 0" ng-include src="'mycompanybundle/training/session/states/detail/partials/inscriptions.html'" ng-controller="SessionInscriptionsController"></div>
                        <!-- closed inscriptions -->
                        <div ng-if="session.registration == 0" ng-include src="'mycompanybundle/training/session/states/detail/partials/participants-summary.html'" ng-controller="SessionParticipantsSummaryController"></div>
                    </div>
                </div>
            </div>

            <!--
             Emails
            -->
            <div ng-show="tab === 'messages'">
                <div class="row mb-1">
                    <div class="col-lg-12">
                        <div entity-emails session="session.id"></div>
                    </div>
                </div>
            </div>
        </div>


        <!--
         Sidebar
        -->
        <div class="col-md-4 sidebar">

            <!--
             Url
            -->
            <div class="block">
                <div class="block-body">
                    <div input-copy-clipboard="session.frontUrl"></div>
                </div>
            </div>

            <!--
             Trainers
            -->
            <div trainers-block="session"></div>

            <!--
             MATERIALS
            -->
            <div materials-block="session" entity-type="'session'"></div>

            <!--
             Comments
            -->
            <div class="block block-comments">
                <div class="block-title">
                    <span class="fa fa-comment-o"></span> Commentaires
                </div>
                <div class="block-body">
                    <span sf-xeditable="form.children.comments" data-type="textarea">{{ session.comments }}</span>
                </div>
            </div>
        </div>
    </div>

</form>
